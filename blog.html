<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>æˆ‘çš„åšæœäº‘æ–‡æ¡£æµè§ˆ</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fafafa; padding: 20px; }
    h2 { margin-bottom: 10px; }
    ul { list-style: none; padding-left: 20px; }
    li { margin: 6px 0; }
    a { text-decoration: none; color: #007bff; }
    a:hover { text-decoration: underline; }
    .breadcrumb { margin-bottom: 16px; font-size: 14px; color: #555; }
  </style>
</head>
<body>
  <h2>ğŸ“ æˆ‘çš„åšæœäº‘</h2>
  <div class="breadcrumb" id="breadcrumb">é¦–é¡µ</div>
  <ul id="fileList"></ul>

  <script>
    // âœ… â€œæˆ‘çš„åšæœäº‘â€ ä¸ index.html åŒçº§
    const rootFolder = 'æˆ‘çš„åšæœäº‘/';
    const fileListEl = document.getElementById('fileList');
    const breadcrumbEl = document.getElementById('breadcrumb');

    async function loadFolder(path, displayName = 'é¦–é¡µ') {
      const response = await fetch(path);
      const html = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      const links = [...doc.querySelectorAll('a')];
      const items = links.map(a => a.getAttribute('href')).filter(h => h && h !== '../');

      const folders = [];
      const files = [];

      for (const item of items) {
        if (item.endsWith('/')) folders.push(item);
        else files.push(item);
      }

      // é¢åŒ…å±‘å¯¼èˆª
      const relative = path.replace(rootFolder, '');
      const parts = relative.split('/').filter(Boolean);
      breadcrumbEl.innerHTML =
        parts.length === 0
          ? 'é¦–é¡µ'
          : `<a href="#" onclick="loadFolder('${rootFolder}')">é¦–é¡µ</a> / ` +
            parts
              .map((p, i) => {
                const subPath = rootFolder + parts.slice(0, i + 1).join('/') + '/';
                return `<a href="#" onclick="loadFolder('${subPath}')">${p}</a>`;
              })
              .join(' / ');

      fileListEl.innerHTML = '';

      if (folders.length > 0) {
        // âœ… ä»…æ˜¾ç¤ºæ–‡ä»¶å¤¹
        folders.forEach(folder => {
          const li = document.createElement('li');
          const name = folder.replace(/\/$/, '');
          li.innerHTML = `ğŸ“‚ <a href="#" onclick="loadFolder('${path + folder}', '${name}')">${name}</a>`;
          fileListEl.appendChild(li);
        });
      } else if (files.length > 0) {
        // âœ… ä¸€æ—¦æ£€æµ‹åˆ°æ–‡ä»¶ï¼ŒæŒ‰â€œ--â€é€»è¾‘åˆ†ç»„æ˜¾ç¤º
        const grouped = {};
        files.forEach(file => {
          const name = decodeURIComponent(file);
          const parts = name.split('--');
          let current = grouped;
          for (let i = 0; i < parts.length; i++) {
            const part = parts[i].replace(/\.md$/, '');
            if (!current[part]) current[part] = i === parts.length - 1 ? null : {};
            current = current[part] || {};
          }
        });

        function renderTree(node, container) {
          for (const key in node) {
            const li = document.createElement('li');
            if (node[key] === null) {
              li.textContent = key; // æ–‡ä»¶
            } else {
              li.innerHTML = `<strong>${key}</strong>`;
              const ul = document.createElement('ul');
              renderTree(node[key], ul);
              li.appendChild(ul);
            }
            container.appendChild(li);
          }
        }

        renderTree(grouped, fileListEl);
      } else {
        fileListEl.innerHTML = '<li>ï¼ˆç©ºæ–‡ä»¶å¤¹ï¼‰</li>';
      }
    }

    // âœ… åˆå§‹åŒ–é¦–é¡µï¼šæ˜¾ç¤ºâ€œæˆ‘çš„åšæœäº‘â€ä¸‹çš„æ–‡ä»¶å¤¹
    loadFolder(rootFolder);
  </script>
</body>
</html>

